var isIe=/MSIE [56789]/.test(navigator.userAgent)&&(navigator.platform=="Win32");if(isIe){var lSbId="sb_id";document.DomL3XPathRelease="0.0.3.0";document._SbReParse=0;var XPathException=new _XPathExceptionHandler();function _XPathExceptionHandler(){this.INVALID_EXPRESSION_ERR=51;this.TYPE_ERR=52;this.NOT_IMPLEMENTED_ERR=-1;this.RUNTIME_ERR=-2;this.ThrowNotImplemented=function(b){a(this.NOT_IMPLEMENTED_ERR,"This functionality is not implemented.",b)};this.ThrowInvalidExpression=function(b){a(this.INVALID_EXPRESSION_ERR,"Invalid expression",b)};this.ThrowType=function(b){a(this.TYPE_ERR,"Type error",b)};this.Throw=function(b){a(this.RUNTIME_ERR,"Run-time error",b)};function a(e,d,c){var b=new Error(e,"DOM-L3-XPath "+document.DomL3XPathRelease+": "+d+(c?', "'+c+'"':""));b.code=e;b.name="XPathException";throw b}}var DOMException=new _DOMExceptionHandler();function _DOMExceptionHandler(){this.ThrowInvalidState=function(b){a(13,"The state of the object is no longer valid",b)};function a(e,d,c){var b=new Error(e,"DOM : "+d+(c?', "'+c+'"':""));b.code=e;b.name="DOMException";throw b}}document.createExpression=function(b,a){return new XPathExpression(b,a)};document.createNSResolver=function(a){return new XPathNSResolver(a)};document.evaluate=function(e,b,d,c,a){return document.createExpression(e,d).evaluate(b,c,a)};function XPathExpression(b,a){this.expressionString=b;this.resolver=a;this.evaluate=function(d,e,c){return(c&&c.constructor==XPathResult?c.initialize(this,d,a,e):new XPathResult(this,d,a,e))};this.toString=function(){return"[XPathExpression]"}}function XPathNSResolver(a){this.node=a;this.lookupNamespaceURI=function(b){XPathException.ThrowNotImplemented();return null};this.toString=function(){return"[XPathNSResolver]"}}XPathResult.ANY_TYPE=0;XPathResult.NUMBER_TYPE=1;XPathResult.STRING_TYPE=2;XPathResult.BOOLEAN_TYPE=3;XPathResult.UNORDERED_NODE_ITERATOR_TYPE=4;XPathResult.ORDERED_NODE_ITERATOR_TYPE=5;XPathResult.UNORDERED_SNAPSHOT_TYPE=6;XPathResult.ORDERED_SNAPSHOT_TYPE=7;XPathResult.ANY_UNORDERED_NODE_TYPE=8;XPathResult.FIRST_ORDERED_NODE_TYPE=9;function XPathResult(h,e,b,i){this.initialize=function(o,l,n,m){this._domResult=null;this._expression=o;this._contextNode=l;this._resolver=n;if(m){this.resultType=m;this._isIterator=(m==XPathResult.UNORDERED_NODE_ITERATOR_TYPE||m==XPathResult.ORDERED_NODE_ITERATOR_TYPE||m==XPathResult.ANY_TYPE);this._isSnapshot=(m==XPathResult.UNORDERED_SNAPSHOT_TYPE||m==XPathResult.ORDERED_SNAPSHOT_TYPE);this._isNodeSet=m>XPathResult.BOOLEAN_TYPE}else{this.resultType=XPathResult.ANY_TYPE;this._isIterator=true;this._isSnapshot=false;this._isNodeSet=true}return this};this.initialize(h,e,b,i);this.getInvalidIteratorState=function(){return k()||!this._isIterator};this.getSnapshotLength=function(){if(!this._isSnapshot){XPathException.ThrowType("Snapshot is not an expected result type")}f(this);return this._domResult.length};this.iterateNext=function(){if(!this._isIterator){XPathException.ThrowType("Iterator is not an expected result type")}f(this);if(k()){DOMException.ThrowInvalidState("iterateNext")}return j(this)};this.snapshotItem=function(l){if(!this._isSnapshot){XPathException.ThrowType("Snapshot is not an expected result type")}return g(this,l)};this.toString=function(){return"[XPathResult]"};this.getStringValue=function(){if(this.resultType!=XPathResult.STRING_TYPE){XPathException.ThrowType("The expression can not be converted to return String")}return a(this)};this.getNumberValue=function(){if(this.resultType!=XPathResult.NUMBER_TYPE){XPathException.ThrowType("The expression can not be converted to return Number")}var l=parseInt(a(this));if(isNaN(l)){XPathException.ThrowType("The result can not be converted to Number")}return l};this.getBooleanValue=function(){if(this.resultType!=XPathResult.BOOLEAN_TYPE){XPathException.ThrowType("The expression can not be converted to return Boolean")}var l=a(this);bool=(l?l.toLowerCase():null);if(bool=="false"||bool=="true"){return bool}XPathException.ThrowType("The result can not be converted to Boolean")};this.getSingleNodeValue=function(){if(this.resultType!=XPathResult.ANY_UNORDERED_NODE_TYPE&&this.resultType!=XPathResult.FIRST_ORDERED_NODE_TYPE){XPathException.ThrowType("The expression can not be converted to return single Node value")}return d(this)};function k(){return document._XPathMsxmlDocumentHelper.documentChangeDetected()}function a(l){f(l);return l._textResult}function c(l,n){switch(n.nodeType){case 1:o=n.attributes.getNamedItem(lSbId);if(o){return(document.getElementsByName(o.value))[0]}XPathException.Throw("unable to locate element in XML tree");case 2:var o=n.selectSingleNode("..").attributes.getNamedItem(lSbId);if(o){var m=document.getElementsByName(o.text);if(m){return(m[0]).attributes.getNamedItem(n.nodeName)}}XPathException.Throw("unable to locate attribute in XML tree");case 3:var o=n.selectSingleNode("..").attributes.getNamedItem(lSbId);if(o){var m=document.getElementsByName(o.value);if(m){for(child in (m[0]).childNodes){if(child.nodeType==3&&child.nodeValue==n.nodeValue){return child}}}}XPathException.Throw("unable to locate text in XML tree")}XPathException.Throw("unknown node type")}function f(l){if(!l._domResult){try{var n=l._expression.expressionString;if(l._contextNode!=document&&n.indexOf("//")!=0){n="//*[@id = '"+l._contextNode.id+"']"+(n.indexOf("/")==0?"":"/")+n}if(l._isNodeSet){l._domResult=document._XPathMsxmlDocumentHelper.getDom().selectNodes(n)}else{l._domResult=true;l._textResult=document._XPathMsxmlDocumentHelper.getTextResult(n)}}catch(m){XPathException.ThrowInvalidExpression(m.description)}}}function d(l){var m=g(l,0);l._domResult=null;return m}function g(l,m){f(l);var n=l._domResult.item(m);return(n?c(l,n):null)}function j(l){var m=l._domResult.nextNode;if(m){return c(l,m)}l._domResult=null;return null}}document.reloadDom=function(){document._XPathMsxmlDocumentHelper.reset()};document.sbReParse=function(){document._SbReParse=1};document._XPathMsxmlDocumentHelper=new _XPathMsxmlDocumentHelper();function _XPathMsxmlDocumentHelper(){this.getDom=function(){d(this);return this.dom};this.getXml=function(){d(this);return this.dom.xml};this.getTextResult=function(j){j=j.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,'"');var g='<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"><xsl:output method="text"/><xsl:template match="*"><xsl:value-of select="'+j+'"/></xsl:template></xsl:stylesheet>';var i=new ActiveXObject("Msxml2.DOMDocument");i.loadXML(g);try{var f=this.getDom().transformNode(i)}catch(h){}return f};this.reset=function(){this.dom=null};function c(){document._propertyChangeDetected=true}this.documentChangeDetected=function(){return(document.ignoreDocumentChanges?false:this._currentElementCount!=document.all.length||document._propertyChangeDetected)};function d(f){if(!f.dom){var g=new ActiveXObject("Msxml2.DOMDocument");g.setProperty("SelectionLanguage","XPath");g.async=false;g.resolveExternals=false;a(g,f);f.dom=g;f._currentElementCount=document.all.length;document._propertyChangeDetected=false}else{if(f.documentChangeDetected()){var g=f.dom;g.load("");a(g,f);f._currentElementCount=document.all.length;document._propertyChangeDetected=false}}}function a(g,f){return e(g,g,document.body,f)}function e(j,k,g,f){var m=g.nodeName;if(m.indexOf("/")>-1||m==""||m=="#document"||m=="#document-fragment"||m=="#cdata-section"||m=="#xml-declaration"||m=="#whitespace"||m=="#significat-whitespace"||m=="#comment"){return}if(g.nodeType!=3){if(g.getAttribute(lSbId)&&document._SbReParse!=1){return}g.setAttribute(lSbId,g.uniqueID);var p=g.nodeName.toLowerCase();var h=j.createElement(p);k.appendChild(h);b(j,h,g);var o=g.childNodes;var n=0;if(o){n=o.length}for(var l=0;l<n;l++){if((o[l].nodeType!=3)&&(o[l].nodeName.toLowerCase()!="b")){e(j,h,o[l],f)}}g.attachEvent("onpropertychange",c)}}function b(l,f,i){var j;var h=i.id;var g=i.className;var k=i.getAttribute(lSbId);if(h){j=l.createAttribute("id");j.value=h;f.setAttributeNode(j)}if(g){j=l.createAttribute("class");j.value=g;f.setAttributeNode(j)}if(k){j=l.createAttribute(lSbId);j.value=k;f.setAttributeNode(j)}}}}else{document.reloadDom=function(){};document.sbReParse=function(){};XPathResult.prototype.getStringValue=function(){return this.stringValue};XPathResult.prototype.getNumberValue=function(){return this.numberValue};XPathResult.prototype.getBooleanValue=function(){return this.booleanValue};XPathResult.prototype.getSingleNodeValue=function(){return this.singleNodeValue};XPathResult.prototype.getInvalidIteratorState=function(){return this.invalidIteratorState};XPathResult.prototype.getSnapshotLength=function(){return this.snapshotLength};XPathResult.prototype.getResultType=function(){return this.resultType}};